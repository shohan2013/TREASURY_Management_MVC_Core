<script src="~/customjs/treasury/LoanRelatedDoc.js"></script>
<script src="~/customjs/common.js"></script>


<div ng-app="App" ng-controller="Ctl" ng-init="GetData()">
    <div class="row" ng-init="GetUnit()">
        <div class="col-sm-12">
            <div class="card">
                <div class="card-header">
                    <h4>Details Of Mortgage Landing</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-4">
                            <button style="margin-top:32px" type="button" class="btn btn-primary btn-sm insert" ng-click="Clear()" data-bs-toggle="modal" data-bs-target="#exampleModal"><i class="mdi mdi-plus me-1"></i> Create New</button>
                        </div>
                        <div class="col-sm-4">
                            <label>Select Bank</label>
                            <select class="form-select" ng-model="bankid" ng-change="LoadData()"
                                    id="bankid">
                                <option value="">--Select--</option>
                                <option ng-repeat="list in banklist" value="{{list.id}}">
                                    {{list.name}}
                                </option>
                            </select>
                        </div>


                        <div class="col-sm-4">
                            <label>Search</label>
                            <input type="text" ng-model="search" class="form-control" placeholder="Search.." />
                        </div>
                    </div><br />

                    <div class="row table-responsive">
                        <div ng-if="loading" class="spinner-wrapper">
                        </div>
                        <div class="col-sm-12">
                            <table id="tblinfo" class="table table-responsive" ng-if="!loading">
                                <tr>
                                    <th style="display:none;">ID</th>
                                    <th>Sl No</th>
                                    <th ng-click='sortBy("lenderunit")'>
                                        Code
                                        <span ng-show="sortColumn=='lenderunit'" ng-class="{'fa fa-angle-double-down' : !reverse, 'fa fa-angle-double-up' : reverse}"></span>
                                    </th>
                                    <th ng-click='sortBy("borrowerunit")' style="display:none">
                                        Bank ID
                                        <span ng-show="sortColumn=='borrowerunit'" ng-class="{'fa fa-angle-double-down' : !reverse, 'fa fa-angle-double-up' : reverse}"></span>
                                    </th>
                                    <th ng-click='sortBy("startdate")'>
                                        Bank Name
                                        <span ng-show="sortColumn=='startdate'" ng-class="{'fa fa-angle-double-down' : !reverse, 'fa fa-angle-double-up' : reverse}"></span>
                                    </th>
                                    <th ng-click='sortBy("enddate")' style="display:none">
                                        Unit ID
                                        <span ng-show="sortColumn=='enddate'" ng-class="{'fa fa-angle-double-down' : !reverse, 'fa fa-angle-double-up' : reverse}"></span>
                                    </th>

                                    <th ng-click='sortBy("interestrate")'>
                                        Unit Name
                                        <span ng-show="sortColumn=='interestrate'" ng-class="{'fa fa-angle-double-down' : !reverse, 'fa fa-angle-double-up' : reverse}"></span>
                                    </th>

                                    <th ng-click='sortBy("interestamt")' style="color:rgb(252, 176, 64)">
                                        Total Facility
                                        <span ng-show="sortColumn=='interestamt'" ng-class="{'fa fa-angle-double-down' : !reverse, 'fa fa-angle-double-up' : reverse}"></span>
                                    </th>

                                    <th ng-click='sortBy("details")'>
                                        Mortgage land Details
                                        <span ng-show="sortColumn=='details'" ng-class="{'fa fa-angle-double-down' : !reverse, 'fa fa-angle-double-up' : reverse}"></span>
                                    </th>
                                    <th ng-click='sortBy("details")'>
                                        No of Acre
                                        <span ng-show="sortColumn=='details'" ng-class="{'fa fa-angle-double-down' : !reverse, 'fa fa-angle-double-up' : reverse}"></span>
                                    </th>
                                    <th ng-click='sortBy("details")'>
                                        Legal Record[Acre]
                                        <span ng-show="sortColumn=='details'" ng-class="{'fa fa-angle-double-down' : !reverse, 'fa fa-angle-double-up' : reverse}"></span>
                                    </th>
                                    <th ng-click='sortBy("details")'>
                                        Free Land Quantity[Acre]
                                        <span ng-show="sortColumn=='details'" ng-class="{'fa fa-angle-double-down' : !reverse, 'fa fa-angle-double-up' : reverse}"></span>
                                    </th>
                                    <th>Action</th>
                                </tr>
                                <tr dir-paginate="list in list | orderBy: sortColumn : reverse | filter:search | itemsPerPage:8">

                                    <td style="display:none;">{{list.id}}</td>
                                    <td>{{$index+1}}</td>
                                    <td>{{list.code}}</td>
                                    <td style="display:none">{{list.bankId}}</td>
                                    <td>{{list.bankName}}</td>

                                    <td style="display:none">{{list.unitId}}</td>
                                    <td>{{list.unitName}}</td>

                                    <td>{{list.totalFacility}}</td>
                                    <td style="background-color:rgb(240, 243, 255)">{{list.detailsOfMortgageLand}}</td>
                                    <td>{{list.noOfAcre}}</td>
                                    <td>{{list.noOfAcrePerLegalRecord}}</td>
                                    <td>{{list.freeLandQuantity}}</td>
                                    <td>
                                        @* <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#ViewModalFullscreen" ng-click="ViewMaster(list.sanctionno)"><span class="fas fa-search-plus"></span></button> *@
                                        <button type="button" ng-disabled="list.docstatuscode=='COMP' || list.docstatuscode=='APPR' || list.docstatuscode=='REJC'" data-bs-toggle="modal" class="btn btn-warning btn-sm edit" data-bs-target="#EexampleModal" ng-click="Edit(list.id)"><span class="bx bx-edit-alt"></span></button>
                                        <button type="button" ng-disabled="list.docstatuscode=='COMP' || list.docstatuscode=='APPR' || list.docstatuscode=='REJC'" class="btn btn-danger btn-sm delete" ng-click="DeleteMaster(list.id)"><span class="bx bxs-trash-alt"></span></button>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">
                        </div>
                        <div class="col-sm-6">
                            <dir-pagination-controls max-size="10" style="font-size:16px;"
                                                     direction-links="true"
                                                     boundary-links="true">
                            </dir-pagination-controls>

                        </div>
                        <div class="col-sm-2">
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-backdrop="static">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background-color:rgb(249, 250, 250);">
                    <h5 class="card-title" id="exampleModalLabel">Details of Mortgage Land (Creation) <b></b></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form class="needs-validation">

                        <div class="row">
                            <div class="col-sm-6">
                                <label>Bank Name:</label>
                                <select class="form-select" ng-model="bankid" ng-init="GetBankInfoByUnit()"
                                        id="bankid">
                                    <option value="">--Select--</option>
                                    <option ng-repeat="list in banklist" value="{{list.id}}">
                                        {{list.name}}
                                    </option>
                                </select>
                                <span class="error">Select Unit</span>
                            </div>

                            <div class="col-sm-6">
                                <label>Unit :</label>
                                <select class="form-select" ng-model="unitid"
                                        id="unitid">
                                    <option value="">--Select--</option>
                                    <option ng-repeat="list in unitlist" value="{{list.id}}">
                                        {{list.name}}
                                    </option>
                                </select>
                                <span class="error">Select Unit</span>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-6">
                                <label>Total Facility[Crore]:</label>
                                <input type="text" class="form-control" placeholder="Amount..." id="txtFacilityAmt" onkeypress="return isNumber(event)" />
                                <span class="error">Facility Amt Required.</span>
                            </div>

                            <div class="col-sm-6">
                                <label>
                                    Details of Mortgage Land
                                </label>
                                <input type="text" class="form-control" placeholder="Amount..." id="txtMortgage" onkeypress="return isNumber(event)" />
                                <span class="error">Amount Required.</span>
                            </div>
                        </div>


                        <div class="row">
                            <div class="col-sm-4">
                                <label>
                                    No. Of Acre<br />
                                    [Land]
                                </label>
                                <input type="text" class="form-control" placeholder="Amount..." id="txtNoOfAcre" onkeypress="return isNumber(event)" />
                                <span class="error">Select Currency.</span>
                            </div>

                            <div class="col-sm-4">
                                <label>
                                    No. Of Acre <br />
                                   [Legal Record]
                                </label>
                                <input type="text" class="form-control" placeholder="Amount..." id="txtNoOfAcreLegal" onkeypress="return isNumber(event)" />
                            </div>
                            <div class="col-sm-4">
                                <label>
                                    Free Land <br />
                                    Quantity
                                </label>
                                <input type="text" class="form-control" placeholder="Amount..." id="txtFreeLandQuantity" onkeypress="return isNumber(event)" />
                            </div>
                        </div>


                        <div class="row">
                            <div class="col-sm-12">
                                <label>Attachment</label>
                                <input id="fileInput" name="fileInput" class="form-control" type="file" multiple>
                            </div>
                        </div>

                    </form>
                </div>

                <div class="modal-footer" style="background-color:rgb(249, 250, 250)">
                    <button type="button" ng-click="Clear()" class="btn btn-warning" data-bs-dismiss="modal"><i class="fas fa-times-circle"></i> Close</button>
                    <button ng-click="Save()" type="button" class="btn btn-primary"><i class="fas fa-check"></i> Submit</button>
                </div>

            </div>
        </div>

    </div>



    <div class="modal fade" id="EexampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-backdrop="static">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background-color:rgb(249, 250, 250);">
                    <h5 class="card-title" id="exampleModalLabel">Details of Mortgage Land (Edit)</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form class="needs-validation">
                        <input type="hidden" id="eid" />
                        <div class="row">
                            <div class="col-sm-6">
                                <label>Bank Name:</label>
                                <select class="form-select" ng-model="ebankid" ng-init="GetBankInfoByUnit()"
                                        id="ebankid">
                                    <option value="">--Select--</option>
                                    <option ng-repeat="list in banklist" value="{{list.id}}">
                                        {{list.name}}
                                    </option>
                                </select>
                                <span class="error">Select Unit</span>
                            </div>

                            <div class="col-sm-6">
                                <label>Unit :</label>
                                <select class="form-select" ng-model="eunitid"
                                        id="eunitid">
                                    <option value="">--Select--</option>
                                    <option ng-repeat="list in unitlist" value="{{list.id}}">
                                        {{list.name}}
                                    </option>
                                </select>
                                <span class="error">Select Unit</span>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-6">
                                <label>Total Facility[Crore]:</label>
                                <input type="text" class="form-control" placeholder="Amount..." id="etxtFacilityAmt" onkeypress="return isNumber(event)" />
                                <span class="error">Facility Amt Required.</span>
                            </div>

                            <div class="col-sm-6">
                                <label>
                                    Details of Mortgage Land
                                </label>
                                <input type="text" class="form-control" placeholder="Amount..." id="etxtMortgage" onkeypress="return isNumber(event)" />
                                <span class="error">Amount Required.</span>
                            </div>
                        </div>


                        <div class="row">
                            <div class="col-sm-4">
                                <label>
                                    No. Of Acre<br />
                                    [Land]
                                </label>
                                <input type="text" class="form-control" placeholder="Amount..." id="etxtNoOfAcre" onkeypress="return isNumber(event)" />
                                <span class="error">Select Currency.</span>
                            </div>

                            <div class="col-sm-4">
                                <label>
                                    No. Of Acre <br />
                                    [Legal Record]
                                </label>
                                <input type="text" class="form-control" placeholder="Amount..." id="etxtNoOfAcreLegal" onkeypress="return isNumber(event)" />
                            </div>
                            <div class="col-sm-4">
                                <label>
                                    Free Land <br />
                                    Quantity
                                </label>
                                <input type="text" class="form-control" placeholder="Amount..." id="etxtFreeLandQuantity" onkeypress="return isNumber(event)" />
                            </div>
                        </div>


                        <div class="row">
                            <div class="col-sm-12">
                                <label>Attachment</label>
                                <input id="efileInput" name="fileInput" class="form-control" type="file" multiple>
                            </div>
                        </div>

                    </form>
                </div>
                <div class="modal-footer" style="background-color:rgb(249, 250, 250)">
                    <button type="button" ng-click="Clear()" class="btn btn-warning" data-bs-dismiss="modal"><i class="fas fa-times-circle"></i> Close</button>
                    <button ng-click="Update()" type="button" class="btn btn-primary"><i class="fas fa-check"></i> Update</button>
                </div>
            </div>
        </div>
    </div>

    <div id="ViewModalFullscreen" class="modal fade" tabindex="-1" aria-labelledby="ViewModalFullscreen" aria-hidden="true">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="myExtraLargeModalLabel">Bank Loan (Attachment)</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form class="needs-validation" novalidate>
                        <div class="row">
                            <div class="col-sm-12">
                                <h5>Attachment</h5>
                                <table class="table table-bordered">
                                    <tr>
                                        <th style="width:80px;">Sl No</th>
                                        <th style="width:400px;">File Name</th>
                                        <th style="width:100px;">Action</th>
                                    </tr>
                                    <tbody id="tblData"></tbody>
                                </table>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-warning sm" data-bs-dismiss="modal"><i class="fas fa-times-circle"></i></button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

</div>
